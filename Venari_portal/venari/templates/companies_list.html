<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./../static/css/companies_list.css">

</head>

<body style="font-family: Poppins;">
    <!-- Sidebar -->

    <div>

        {% include 'adminSB_NB.html' %}

    </div>



    <div id="companies-list-main-container" class="overflow-auto">



        <div class="container mx-auto py-1">


            <div class="card comp-list-cards" id="head-parent-card">
                <div class="row justify-content-center align-items-center g-2">
                    <div class="col-md-4">
                        <div class="col-12">
                            <div class="card border-0 d-flex flex-row align-items-center comp-list-cards"
                                style="min-height: 175px;" id="comp-list-card1">
                                <div class="row g-0">
                                    <div class="card-body">

                                        <div class="d-flex align-items-center">
                                            <div class="flex-shrink-0 fs-4 me-3 pb-0">
                                                <i class="bi bi-buildings"></i>
                                            </div>

                                            <div class="flex-grow-1 text-start">
                                                <h1 class="card-title mb-0 pb-0">{{ all_company }}</h1>
                                                <p class="text-muted dash-card-label pt-0 pb-0 mb-0">
                                                    All Companies
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8 ps-md-2">
                        <h3 class="fw-bolder mb-4" id="headCompList">
                            Manage Companies</h3>


                        <div class="col-12">
                            <!-- Search -->
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="" id="companySearch"
                                    aria-label="Button" aria-describedby="" />
                                <button class="btn btn-secondary" type="button" id="comp-list-search-btn"
                                    onclick="search_company()">
                                    <i class="bi bi-search"></i><span class="ms-2 d-none d-md-inline">Search</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>









            <!-- Table -->
            <div class="card border-0 overflow-auto p-2 p-lg-4 flex-grow-1 comp-list-cards" style="height: 500px;"
                id="comp-list-table-card">

                <div class="d-flex">
                    <span class="flex-grow-1" id="acceptedLabel">Accepted Companies</span>
                    <span class="flex-grow-1" id="pendingLabel">Pending Companies</span>

                    <div class="dropdown flex-shrink-0 p-0 m-0">
                        <a class="btn btn-primary dropdown-toggle btn-sm" href="#" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false" id="tableSelector">
                            Tables
                        </a>

                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" data-table="accepted">Accepted Companies</a></li>
                            <li><a class="dropdown-item" href="#" data-table="pending">Pending Companies</a></li>
                        </ul>

                    </div>
                </div>

                <hr class="text-light">

                <table class="table align-middle table-hover" id="comp_list_table" data-table-type="accepted">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">Name of Company</th>
                            <th scope="col" class="text-center">Number of Applicants</th>
                            <th scope="col" class="text-center">Number of Job Postings</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for company in companies %}
                        <tr>
                            {% if company.status == 'Accepted' %}

                            <th scope="row">
                                <div id="complist-pic-container">
                                    <img src="{{company.company_logo.url}}" alt="Company Logo" id="complist-table-pic"
                                        class="">
                                </div>

                            </th>
                            <td>{{company.company_name}}</td>
                            <td class="text-center">{{ company.applicant_count }}</td>
                            <td class="text-center">{{ company.posted_job_count }}</td>
                            <td>
                                <div class="row justify-content-center align-items-center g-1">
                                    <div class="col">
                                        <button type="button" class="btn btn-primary" id="comp-view-button" name="edit"
                                            data-bs-toggle="modal" data-bs-target="#editCompanyModal" data-post-id="{{ company.id }}">
                                            <i class="bi bi-pencil-fill"></i>
                                        </button>

                                    </div>
                                    <div class="col">
                                        <button type="button" class="btn btn-danger" name="delete"
                                            id="comp-archive-button" data-bs-toggle="modal"
                                            data-bs-target="#archiveModal" data-post-id="{{ company.id }}">
                                            <i class="bi bi-trash-fill"></i>
                                        </button>

                                    </div>
                                </div>

                            </td>

                            {% endif %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

                <!-- table 2 -->
                <table class="table align-middle" id="comp_list_pending_table" data-table-type="pending">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">Name of Company</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for company in companies %}
                        <tr>
                            {% if company.status != 'Accepted' %}

                            <th scope="row">
                                <div id="complist-pic-container">
                                    <img src="{{company.company_logo.url}}" alt="Company Logo" id="complist-table-pic"
                                        class="">
                                </div>

                            </th>
                            <td>{{company.company_name}}</td>
                            <td>
                                <div class="row justify-content-start align-items-center g-1">
                                    <div class="col-md-3">
                                        <button id = "activateButton" type="button" class="activateButton btn btn-primary"
                                            data-bs-toggle="modal" data-bs-target="#comp-accept-modal" data-post-id="{{company.id}}" data-status="Accepted"
                                            >
                                            <i class="bi bi-check-lg"></i>
                                        </button>

                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" class="btn btn-danger" name="reject"
                                            id="comp-reject-button" data-bs-toggle="modal"  data-bs-target="#comp-reject-modal" data-post-id="{{company.id}}">
                                            <i class="bi bi-x-lg"></i>
                                        </button>

                                    </div>
                                </div>

                            </td>

                            {% endif %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

            </div>

            <!-- 
                    <div class="mt-5 rounded-lg overflow-hidden border border-red-500 overflow-x-auto">
                        <table class="table-auto w-full text-center">

                            <tbody>

                                <tr>
                                    <td class="border-b border-red-300 pl-2 sm:pl-4 pr-1 sm:pr-2 py-1 sm:py-2">
                                       </td>
                                    <td
                                        class="border-b border-red-300 text-red-600 px-2 sm:px-4 py-1 sm:py-2 text-sm sm:text-base">
                                        {{company.company_name}}</td>
                                    <td
                                        class="border-b border-red-300 text-red-600 px-2 sm:px-4 py-1 sm:py-2 text-sm sm:text-base">
                                        {{ company.applicant_count }}</td>
                                    <td
                                        class="border-b border-red-300 text-red-600 px-2 sm:px-4 py-1 sm:py-2 text-sm sm:text-base">
                                        {{ company.posted_job_count }}</td>
                                    <td class="border-b border-red-300 px-2 sm:px-4 py-1 sm:py-2 text-sm sm:text-base">

                                    </td>
                                </tr>
                                More rows...
                            </tbody>
                        </table>
                    </div>Table -->



            <!-- Pagination -->
            <div class="mt-3">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-end">
                        <li class="page-item disabled">
                            <a class="page-link">Previous</a>
                        </li>
                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                            <a class="page-link" href="#">Next</a>
                        </li>
                    </ul>
                </nav>
            </div>

        </div>
    </div>


    <!-- ========== Start Section Delete Modal ========== -->



    <!-- Modal Body -->
    <!-- if you want to close by clicking outside the modal, delete the last endpoint:data-bs-backdrop and data-bs-keyboard -->
    <div class="modal fade" id="archiveModal" tabindex="-1" role="dialog" aria-labelledby="archiveModalTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="archiveModalTitle">
                        Archive Company
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">Do you want to archive this company?</div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        No
                    </button>
                    <button type="button" class="btn btn-primary" id="confirm_delete">Yes</button>
                </div>
            </div>
        </div>
    </div>
    <!-- ========== End Section Delete Modal ========== -->

    <!-- ========== Start Section Edit Modal ========== -->


    <!-- Modal Body -->
    <!-- if you want to close by clicking outside the modal, delete the last endpoint:data-bs-backdrop and data-bs-keyboard -->
    <div class="modal fade" id="editCompanyModal" tabindex="-1" role="dialog" aria-labelledby="editCompanyModalTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editCompanyModalTitle">
                        Edit company
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                    <form method = "POST" action="{% url 'admin_edit_company' %}" id="editCompany">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="" class="form-label">Company Name</label>
                            <input type="text" class="form-control" name="company_name" id="company_name" aria-describedby="helpId"
                                placeholder="" />
                                <input type="hidden" class="form-control" name="company_id" id="company_id" value="">
                        </div>

                        <div class="row justify-content-center align-items-center g-2">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editFirstName" class="form-label">First Name</label>
                                    <input type="text" class="form-control" name="first_name" id="first_name"
                                        placeholder="Juan" />

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editFirstName" class="form-label">Last Name</label>
                                    <input type="text" class="form-control" name="last_name" id="last_name"
                                        placeholder="Dela Cruz" />

                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editCeo" class="form-label">CEO/Founder</label>
                            <input type="text" class="form-control" name="ceo" id="ceo" placeholder="" />
                        </div>


                        <div class="mb-3">
                            Gender<br>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="gender" id="male" value="Male">
                                <label class="form-check-label" for="male">Male</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="gender" id="female" value="Female">
                                <label class="form-check-label" for="female">Female</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="gender" id="non-binary" value="Non-binary">
                                <label class="form-check-label" for="non-binary">Non-binary</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="gender" id="not-say" value="Prefer not to say">
                                <label class="form-check-label" for="not-say">Prefer not to say</label>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editYearEstablished" class="form-label">Year Established</label>
                            <input type="date" class="form-control" name="year_established" id="year_established"
                                placeholder="" />
                        </div>

                        <div class="mb-3">
                            <label for="editMobileNumber" class="form-label">Mobile Number</label>
                            <input type="number" class="form-control" name="contact" id="company_contact"
                                placeholder="" />
                        </div>

                        <div class="mb-3">
                            <label for="editCompanyLocation" class="form-label">Company Location</label>
                            <input type="text" class="form-control" name="location" id="company_location"
                                placeholder="" />
                        </div>

                        <div class="mb-3">
                            <label for="editCompanyUsername" class="form-label">Company Username</label>
                            <input type="text" class="form-control" name="username" id="company_username"
                                placeholder="" />
                        </div>



                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        Close
                    </button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
            </div>
        </div>
    </div>

    <!-- ========== End Section Edit Modal ========== -->

         <script>
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        
        document.addEventListener('DOMContentLoaded', function () {
            var editButtons = document.querySelectorAll('[name="edit"]');
            var editModal = new bootstrap.Modal(document.getElementById("editCompanyModal"));
            editButtons.forEach(function (button) {
                button.addEventListener('click', function () {
                    var postId = button.getAttribute('data-post-id');
                    document.getElementById('editCompany').setAttribute('data-post-id', postId);
    
                    fetch(`/get_company_data/${postId}/`)  
                        .then(response => response.json())

                        .then(data => {
                            document.getElementById('company_contact').value = data.contact;
                            document.getElementById('company_location').value = data.location;
                            document.getElementById('company_username').value = data.username;
                            document.getElementById('company_id').value = data.company_id;
                            document.getElementById('company_name').value = data.company_name;
                            document.getElementById('first_name').value = data.first_name;
                            document.getElementById('last_name').value = data.last_name;
                            document.getElementById('year_established').value = data.year_established ? data.year_established : '';
                            document.getElementById('ceo').value = data.ceo;
                            if (data.gender === 'Male') {
                            document.getElementById('male').checked = true;
                        } else if (data.gender === 'female') {
                            document.getElementById('Female').checked = true;
                        } else if (data.gender === 'Non-binary') {
                            document.getElementById('non-binary').checked = true;
                        } else if (data.gender === 'Prefer not to say') {
                            document.getElementById('not-say').checked = true;
                        } document.getElementById('btnradio').value = data.gender;
                            editModal.show();
                        })
                        .catch(error => console.error('Error:', error));
                });
            });
    
            document.getElementById('submitEditJobForm').addEventListener('click', function () {
                var postId = document.getElementById('editJobForm').getAttribute('data-post-id');
                
                console.log('Post ID:', postId);
                

                editModal.hide();
            });
        });
        </script>
    </script>
    <script>
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        document.addEventListener('DOMContentLoaded', function () {
            var delete_button = document.querySelectorAll('[name="delete"]');
            var view_button = document.querySelectorAll('.comp-view-button');
            var modalTitle = document.getElementById('archiveModalTitle');
            var modalBody = document.querySelector('#archiveModal .modal-body');
            var confirm_delete_button = document.getElementById('confirm_delete');
            var confirmDeactivationButton = document.getElementById('confirm_deactivation');

            delete_button.forEach(function (button) {
                button.addEventListener('click', function () {
                    var postId = button.getAttribute('data-post-id');
                    modalTitle.innerText = 'Delete Company ';
                    modalBody.innerHTML = 'Do you want to delete this company?';
                    confirm_delete_button.dataset.postId = postId;
                });
            });

            confirm_delete_button.addEventListener('click', function () {
                var postId = confirm_delete_button.dataset.postId;
                fetch(`/admin_delete_company/${postId}/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken'),
                        },
                        body: JSON.stringify({
                            post_id: postId
                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('Company Deleted successfully!');
                            location.reload();
                        } else {
                            alert('Failed to delete the company.');
                        }
                    })
                    .catch(error => console.error('Error:', error));
            });
        });

        function search_company() {
            var searchCompany = document.getElementById('companySearch').value;
            fetch('/search_company/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken'),
                    },
                    body: JSON.stringify({
                        search: searchCompany
                    }),
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {

                    console.log(data);

                    const companyListing = data.company;

                    const companyListingElement = document.getElementById('comp-list-table-card');

                    companyListingElement.innerHTML = `
                    <div class="card border-0 overflow-auto p-2 p-lg-4 flex-grow-1 comp-list-cards" style="height: 500px;"
                id="comp-list-table-card">

                <div class="d-flex">
                    <span class="flex-grow-1" id="acceptedLabel">Accepted Companies</span>
                    <span class="flex-grow-1" id="pendingLabel">Pending Companies</span>

                    <div class="dropdown flex-shrink-0 p-0 m-0">
                        <a class="btn btn-primary dropdown-toggle btn-sm" href="#" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false" id="tableSelector">
                            Tables
                        </a>

                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" data-table="accepted">Accepted Companies</a></li>
                            <li><a class="dropdown-item" href="#" data-table="pending">Pending Companies</a></li>
                        </ul>

                    </div>
                </div>

                <hr class="text-light">
                    <table class="table align-middle table-hover" id="comp_list_table">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">Name of Company</th>
                            <th scope="col" class="text-center">Number of Applicants</th>
                            <th scope="col" class="text-center">Number of Job Postings</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>`;
                    if (companyListing.length === 0) {
                        companyListingElement.innerHTML = '<p>No companies found</p>';
                    } else {
                        const tbody = companyListingElement.querySelector('tbody');
                        companyListing.forEach(company => {
                            if (company.company_status === 'Accepted') {
                                tbody.innerHTML += `
                                    <tr>
                                        <th scope="row">
                                            <div id="complist-pic-container">
                                                <img src="${company.company_logo}" alt="Company Logo" id="complist-table-pic"
                                                    class="">
                                            </div>

                                        </th>
                                        <td>${company.company_name}</td>
                                        <td class="text-center">${ company.applicants }</td>
                                        <td class="text-center">${ company.posted_jobs }</td>
                                        <td>
                                            <div class="row justify-content-center align-items-center g-1">
                                                <div class="col">
                                                    <button type="button" class="btn btn-primary" id="comp-view-button"
                                            data-bs-toggle="modal" data-bs-target="#editCompanyModal">
                                            <i class="bi bi-pencil-fill"></i>
                                        </button>

                                                </div>
                                                <div class="col">
                                                    <button type="button" class="btn btn-danger" name="delete"
                                            id="comp-archive-button" data-bs-toggle="modal"
                                            data-bs-target="#archiveModal" data-post-id="${ company.id }">
                                            <i class="bi bi-trash-fill"></i>
                                        </button>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>`;

                            }
                        });
                    }

                })
                .catch(error => console.error('Error searching for jobs:', error));
        }
    </script>


    <!-- ========== Start Section Toggle Tables ========== -->
    <!-- Include jQuery library -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get references to the tables
            var acceptedTable = document.getElementById('comp_list_table');
            var pendingTable = document.getElementById('comp_list_pending_table');
            var acceptedLabel = document.getElementById('acceptedLabel');
            var pendingLabel = document.getElementById('pendingLabel');

            // Add an event listener to the dropdown items
            var dropdownItems = document.querySelectorAll('.dropdown-item');
            dropdownItems.forEach(function (item) {
                item.addEventListener('click', function (event) {
                    // Prevent the default link behavior
                    event.preventDefault();

                    // Check the data-table attribute of the clicked option
                    var selectedTable = item.getAttribute('data-table');

                    // Show/hide tables based on the selected option
                    if (selectedTable === 'accepted') {
                        acceptedTable.style.display = 'table';
                        pendingTable.style.display = 'none';
                        acceptedLabel.style.display = 'flex';
                        pendingLabel.style.display = 'none';
                    } else if (selectedTable === 'pending') {
                        acceptedTable.style.display = 'none';
                        pendingTable.style.display = 'table';
                        acceptedLabel.style.display = 'none';
                        pendingLabel.style.display = 'flex';
                    }
                });
            });
        });
    </script>
    <!-- ========== End Section Toggle Tables ========== -->


    <!-- ========== Start Section Accept Modal ========== -->

    <!-- Modal Body -->
    <!-- if you want to close by clicking outside the modal, delete the last endpoint:data-bs-backdrop and data-bs-keyboard -->
    <div class="modal fade" id="comp-accept-modal" tabindex="-1" role="dialog" aria-labelledby="comp-accept-modal-title"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="comp-accept-modal-title">
                        Accept Company
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Do you want to accept this company?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        No
                    </button>
                    <button type="button" class="btn btn-primary" id="confirm_activation">Yes</button>
                </div>
            </div>
        </div>
    </div>
    <!-- ========== End Section Accept Modal ========== -->

    <!-- ========== Start Section Reject Modal ========== -->
    <!-- Modal Body -->
    <!-- if you want to close by clicking outside the modal, delete the last endpoint:data-bs-backdrop and data-bs-keyboard -->
    <div class="modal fade" id="comp-reject-modal" tabindex="-1" role="dialog"
        aria-labelledby="comp-reject-modal-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="comp-reject-modal-title">
                        Reject Company
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                     Do you want to reject this company?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        No
                    </button>
                    <button type="button" class="btn btn-primary" id="confirm_reject" >Yes</button>
                </div>
            </div>
        </div>
    </div>


    <!-- ========== End Section Reject Modal ========== -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var delete_button = document.querySelectorAll('[name="delete"]');
        var view_button = document.querySelectorAll('.comp-view-button');
        var modalTitle = document.getElementById('joblistDeleteModalTitle');
        var modalBody = document.querySelector('#joblistDeleteModal .modal-body');
        var confirm_delete_button = document.getElementById('confirm_delete');

        delete_button.forEach(function (button) {
            button.addEventListener('click', function () {
                var postId = button.getAttribute('data-post-id');
                modalTitle.innerText = 'Delete Company ';
                modalBody.innerHTML = 'Do you want to delete this company?';
                confirm_delete_button.dataset.postId = postId;
            });
        });

        confirm_delete_button.addEventListener('click', function () {
            var postId = confirm_delete_button.dataset.postId;
            fetch(`/admin_delete_postjob/${postId}/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken'),
                    },
                    body: JSON.stringify({
                        post_id: postId
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Post Deleted successfully!');
                        location.reload();
                    } else {
                        alert('Failed to delete the company.');
                    }
                })
                .catch(error => console.error('Error:', error));
        });
    });
</script>

<script>
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    document.addEventListener('DOMContentLoaded', function () {
        var activateButtons = document.querySelectorAll('.activateButton');
        var confirmActivationButton = document.getElementById('confirm_activation');

        activateButtons.forEach(function (button) {
            button.addEventListener('click', function () {
                var postId = button.getAttribute('data-post-id');
                var postStatus = button.getAttribute('data-status');
                confirmActivationButton.dataset.postId =
                postId; // Set post ID in the Confirm Activation button
                confirmActivationButton.dataset.status = postStatus; // Set post status
            });
        });
        confirmActivationButton.addEventListener('click', function () {
            var postId = confirmActivationButton.dataset.postId;
            var postStatus = confirmActivationButton.dataset.status;
            alert
            // Perform actions based on the post ID and status
            fetch(`/company_change_status/${postId}/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken'), // Include CSRF token
                    },
                    // Include both post_id and status in the request body
                    body: JSON.stringify({
                        post_id: postId,
                        status: postStatus
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    // Handle the response as needed
                    if (data.success) {
                        alert('Post status changed successfully!');
                        location.reload();
                        // Optionally, you can update the UI to reflect the new status
                    } else {
                        alert('Failed to change the post status.');
                    }
                })
                .catch(error => console.error('Error:', error));
        });

       
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var delete_button = document.querySelectorAll('[name="reject"]');
        var confirm_delete_button = document.getElementById('confirm_reject');

        delete_button.forEach(function (button) {
            button.addEventListener('click', function () {
                var postId = button.getAttribute('data-post-id');
                confirm_delete_button.dataset.postId = postId;
            });
        });

        confirm_delete_button.addEventListener('click', function () {
            var postId = confirm_delete_button.dataset.postId;
            fetch(`/admin_reject_company/${postId}/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken'),
                    },
                    body: JSON.stringify({
                        post_id: postId
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Post Deleted successfully!');
                        location.reload();
                    } else {
                        alert('Failed to delete the company.');
                    }
                })
                .catch(error => console.error('Error:', error));
        });
    });
</script>
</body>

</html>